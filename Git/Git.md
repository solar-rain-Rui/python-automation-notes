

版本控制工具

分布式版本控制系统

**Git优点**：
- 适合分布式开发，强调个体
- 公共服务器压力和数据量不会太大
- 速度快、灵活
- 任意两个开发者之间可以很容易解决冲突
- 离线工作

### gitbash

Git Bash 是一种在 Windows 操作系统上模拟 Linux 和 Unix 命令环境的工具，它作为 Git for Windows 软件包的一部分被安装

1. **Git**：一个强大的**版本控制系统**，用于追踪代码的变更、协作开发项目。它本身是一套命令行程序。
    
2. **Bash**：一个 **Shell**（命令行解释器）。你可以把它想象成一个与操作系统沟通的“翻译官”。Bash 是 Linux 和 macOS 系统默认的 Shell，非常强大和灵活。

Git Bash 的作用就是在 Windows 系统里，为你创建一个“假的” Bash 环境（即模拟环境），让你可以在这个环境里顺畅地使用 Git 命令，并且还能使用很多 Linux 下常用的工具命令

### Git基本概念

#### 文件状态

- 未跟踪(Untracked)   新建的文件，Git 还没有纳入版本控制。
- 未修改(Unmodified) 和仓库里的版本一致
- 已修改(Modified) 你改过，但还没 `git add`
- 已暂存(Staged)  你用 `git add` 放进了暂存区，等着 commit

#### 工作区域

- **工作区**(Working Directory) 
	- 电脑上能直接看到和编辑的文件。比如你在项目里用 VSCode 打开并修改了某个 `.py` 文件，这个就是工作区
- **暂存区**(Staging Area)
	- 临时存放改动的地方。
	-  当你执行 `git add file.py` 时，修改就进入了暂存区。
    
- **仓库区(本地仓库)**(Respository)
	- 通过 `git commit` 把暂存区的内容提交到本地仓库。
    - 这里保存着完整的历史版本。
    - 用 `git log` 就能看到提交记录。

##### 工作流示例

假设有个文件 `main.py`：

1. 新建 `main.py` → 状态是 **Untracked**
    
2. `git add main.py` → 状态变成 **Staged**
    
3. `git commit -m "add main.py"` → 状态变成 **Unmodified**（在仓库里有版本了）
    
4. 修改 `main.py` → 状态变成 **Modified**
    
5. 再次 `git add main.py` → **Staged**
    
6. 再次 `git commit` → **Unmodified**

##### 本地仓库和远程仓库

可以把本地仓库和远程仓库的关系想成 “你家和云端仓库”：

|对比点|本地仓库|远程仓库|
|---|---|---|
|存储位置|你的电脑 `.git`|远程服务器（GitHub/Gitee 等）|
|是否联网可用|不联网也能用|必须联网|
|作用|个人保存、提交、回滚|团队共享、协作|
|数据完整性|完整历史|也完整（通常是同步结果）|
|操作|`git commit` 保存到本地|`git push` 上传，`git pull`/`git fetch` 下载|

#### Git 工作流程核心步骤

1. **修改文件（工作区）**
    
    - 你在本地对文件进行编辑，这时文件状态是 **修改 (modified)**。
        
    - 工作区就是你当前看到的文件夹里的文件。
        
2. **添加到暂存区（staging/index）**
    
    - 命令：`git add <文件名>` 或 `git add .`
        
    - 把修改的文件标记为准备提交。暂存区可以理解为“快照缓存”，它记录了将要提交的内容。
        
3. **提交到本地仓库（commit）**
    
    - 命令：`git commit -m "提交说明"`
        
    - 把暂存区的内容打包保存到本地仓库，形成一个版本（commit）。
        
    - 提交后，暂存区和工作区会同步更新（已提交的文件在工作区和本地仓库一致）。
        
4. **同步到远程仓库（push/pull/fetch/merge）**
    
    - **上传本地提交**：`git push origin main`
        
    - **拉取远程更新**：`git pull`（相当于 `git fetch` + `git merge`）
        
    - 远程仓库通常托管在 GitHub/GitLab/码云，用于团队协作。

#### Git远程仓库

- Github 最主流的远程开源仓库
- Gitee 国内比较主流的开源仓库
- GitLab 私有化部署，企业使用较多

应用场景：
- 获取远程仓库代码：开源代码、项目代码
- 项目协作：维护自己代码、多人维护同一项目

### Git常用命令

#### 仓库相关

| 操作      | 命令                | 说明            |
| ------- | ----------------- | ------------- |
| 初始化本地仓库 | `git init`        | 当前目录变成 Git 仓库 |
| 克隆远程仓库  | `git clone <url>` | 把远程仓库复制到本地    |

##### 远程连接方式

- HTTPS连接：使用给定URL即可clone，在push时验证用户名和密码
- SSH连接：需要提前添加SSH Key，在push时不需要输入用户名，配置SSH时设置了密码才需要输入密码

**HTTPS连接**：

当你使用 HTTPS 克隆或推送远程仓库时，Git 需要 **知道你的身份**，才能把操作记录到你的账号里，并允许你推送到远程仓库。
- Git 会通过 **用户名 + 密码（或 token）** 来验证你是谁。
    
- 但是每次操作都输入账号密码很麻烦，所以可以提前配置 **全局账号**，Git 就知道默认用哪个身份操作。

配置全局账号的命令：
```bash
# 设置用户名（显示在提交记录里）
git config --global user.name "你的名字"

# 设置邮箱（显示在提交记录里）
git config --global user.email "你的邮箱@example.com"

```
- `--global` 表示 **全局生效**，也就是你这个电脑上的所有 Git 仓库都会用这个账号。
    
- 如果只想针对某个仓库配置，可以去掉 `--global`，只在当前仓库生效

验证配置结果：`git config --global --list`

**SSH连接**：

1. 生成SSH Key:
	- `ssh-keygen -t ed25519 -C "your_email@xx.com`
2. 连敲三次回车键
3. 到对应目录下找生成的公钥和密钥

####  远程仓库操作

| 操作     | 命令                            | 说明         |
| ------ | ----------------------------- | ---------- |
| 查看远程仓库 | `git remote -v`               | 查看远程仓库地址   |
| 添加远程仓库 | `git remote add origin <url>` | 本地仓库关联远程仓库 |
| 推送分支   | `git push origin <branch>`    | 上传本地分支到远程  |
| 拉取更新   | `git pull`                    | 拉取远程更新并合并  |
| 克隆仓库   | `git clone <url>`             | 下载远程仓库     |

##### git pull --allow-unrelated-histories

有时候本地仓库关联到远程仓库时，要用`git pull --allow-unrelated-histories`更新下
###### --allow-unrelated-histories的作用

- 正常情况下，Git 合并两个仓库历史时，需要它们 **有共同祖先提交（common ancestor）**。
    
- 如果你本地仓库和远程仓库完全没有关系（比如本地新建了仓库，再去拉取远程已有仓库），Git 会报错：`fatal: refusing to merge unrelated histories`
- `--allow-unrelated-histories` 就是告诉 Git： “我知道这两个历史没有关联，但请强制合并。”

  **使用场景**：

1. 本地仓库和远程仓库都是新建的，之前互不关联
    
    - 例如：你本地写了一些 README 文件，然后想把它和 GitHub 上已有的仓库合并。
        
2. 迁移仓库或初始化仓库后第一次拉取远程代码
    
    - 很多人在克隆前就本地初始化了仓库，这时候第一次 `git pull` 就需要加这个参数。

##### git push --set-upstream origin feature

###### --set-upstream的作用
- 设置 **上游分支（upstream branch）**。
    
- 意思是：**告诉本地分支以后默认跟踪远程 origin/master**，这样你以后就可以直接用：
```bash
git push
git pull
```

 **使用场景**

1. 本地新建分支第一次推送
2. 本地 master 分支和远程 master 第一次关联
    - 如果是新建仓库或刚克隆远程仓库的空分支，需要第一次推送时加 `--set-upstream`

####  文件操作（工作区 → 暂存区 → 本地仓库）

| 操作       | 命令                   | 说明                      |
| -------- | -------------------- | ----------------------- |
| 添加文件到暂存区 | `git add <file>`     | 可以 `git add .` 添加所有修改文件 |
| 从暂存区移除文件 | `git reset <file>`   | 保留工作区修改，撤销暂存            |
| 提交到本地仓库  | `git commit -m "说明"` | 提交暂存区文件到本地仓库            |
| 修改最近一次提交 | `git commit --amend` | 修改上次提交说明或添加文件           |
#### 文件状态查看

| 操作     | 命令                  | 说明                 |
| ------ | ------------------- | ------------------ |
| 查看文件状态 | `git status`        | 显示修改、暂存、未跟踪文件      |
| 查看提交历史 | `git log`           | 按时间顺序显示提交记录        |
| 简单日志   | `git log --oneline` | 一行显示一个提交           |
| 查看分支   | `git branch`        | 列出本地分支，`-a` 查看远程分支 |
##### git diff

`git diff` 用于 **查看文件的修改差异**，显示本地修改相对于 Git 的记录或暂存区的不同

查看 **工作区 vs 暂存区** 的差异
- 显示 你改了哪些内容，但还没有 `git add` 暂存。
    
- 绿色 `+` 表示新增行，红色 `-` 表示删除行。

#### 撤销修改

| 操作      | 命令                       | 说明          |
| ------- | ------------------------ | ----------- |
| 丢弃工作区修改 | `git checkout -- <file>` | 文件回到上次提交状态  |
| 撤销暂存    | `git reset HEAD <file>`  | 文件从暂存区移回工作区 |
| 删除未跟踪文件 | `git clean -f`           | 删除未跟踪的文件    |

#### 分支管理

| 操作    | 命令                         | 说明           |
| ----- | -------------------------- | ------------ |
| 创建分支  | `git branch <branch>`      | 新建分支         |
| 切换分支  | `git checkout <branch>`    | 切换到指定分支      |
| 创建并切换 | `git checkout -b <branch>` | 新建分支并切换      |
| 合并分支  | `git merge <branch>`       | 把指定分支合并到当前分支 |
| 删除分支  | `git branch -d <branch>`   | 删除本地分支       |
#### 忽略文件

- .gitignore文件：在项目根目录下创建一个 `.gitignore` 文件，把要忽略的文件或文件夹写进去
- 有些文件无需纳入Git的管理，比如日志文件或者编译过程中创建的临时文件；如果不忽略，这些文件会被误提交，仓库会越来越大，也不利于协作

- `.gitignore` 控制哪些文件不被 Git 跟踪。
    
- 只对 **未跟踪文件** 生效，已经提交的文件需用 `git rm --cached` 移除。
    
- 可以针对项目写 `.gitignore`，也可以写 **全局忽略**